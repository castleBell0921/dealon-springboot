<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${product.name}">경매 상품 상세</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/App.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/productDetail.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/font.css}">
</head>
<body>
<div class="app-container">
    <div th:replace="~{common/header :: header}"></div>
    <div th:replace="~{common/searchBar :: searchBar}"></div>
    <div class="product-detail-page-container">
        <div class="product-detail-layout">
            <main class="product-main-content">
                <div class="breadcrumb text-13px" th:text="'홈 > ' + ${product.categoryName}"></div>
                <div class="product-info-container">
                	<input type="hidden" th:value="${product.productNo}" id="productNo" name="productNo">
                	<input type="hidden" th:value="${product.userNo}" id="productUserNo">
                	<input type="hidden" th:value="${loginUser.userNo}" id="userNo">
                    <section class="product-image-section">
                        <div class="image-slider-container">
                            <div class="slider-images">
                                <div class="slider-image" th:each="imgUrl : ${product.imageUrls}">
                                    <img th:src="${imgUrl}" th:alt="${product.name}" id="productImage" />
                                </div>
                            </div>
                            <button class="slider-btn prev-btn" th:if="${#lists.size(product.imageUrls) > 1}">&lt;</button>
                            <button class="slider-btn next-btn" th:if="${#lists.size(product.imageUrls) > 1}">&gt;</button>
                            <div class="image-counter" th:if="${!#lists.isEmpty(product.imageUrls)}">
                                <span class="current-image-index">1</span> / <span th:text="${#lists.size(product.imageUrls)}"></span>
                            </div>
                        </div>
                        <div class="product-seller-info">
                            <div class="seller-profile">
                                <div class="seller-avatar-placeholder">
                                    <img th:if="${product.sellerProfileImage != null}" th:src="${product.sellerProfileImage}" alt="판매자 프로필"/>
                                </div>
                                <div class="seller-name text-15px" th:text="${product.sellerNickname}"></div>
                            </div>
                            <div class="trust-gauge-container">
                                <div class="trust-label">
                                    <span>Trust Gauge</span>
                                    <span class="trust-percent" th:text="${product.sellerTrust} + '%'"></span>
                                </div>
                                <div class="trust-bar">
                                    <div class="trust-fill" th:style="'width:' + ${product.sellerTrust} + '%;'"></div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="product-details-section">
                        <div class="product-location text-18px" th:text="${product.location}"></div>
                        <h1 class="product-title text-24px" th:text="${product.name}" id="productName"></h1>
                        <div class="product-meta-info" th:text="${product.createDate} + '·조회 ' + ${product.views}"></div>
                        <div class="product-price text-28px" th:text="${#numbers.formatInteger(product.price, 3, 'COMMA')} + ' 원'"></div>
                        <div class="product-description text-15px" th:text="${product.detail}"></div>
                        <button class="chat-button text-16px sellerChatBtn">판매자에게 채팅하기</button>

                        <div class="product-actions">
                            <th:block th:if="${loginUser != null && loginUser.userNo == product.userNo}">
                                <a th:href="@{/product/updateForm/{no}(no=${product.productNo})}" class="btn btn-primary">
                                    수정하기
                                </a>
                                <button type="button" id="delete-btn" class="btn btn-danger">삭제하기</button>
                            </th:block>
                        </div>
                    </section>

                </div>

                <div class="trade-location-title text-20px">거래 희망 장소</div>
                <div class="product-map-container">
                    <iframe
                            width="100%" height="100%" style="border:0; border-radius: 8px;"
                            th:src="@{'https://map.naver.com/p/search/' + ${product.location}}">
                    </iframe>
                </div>
            </main>
        </div>
    </div>
</div>
<script th:src="@{/js/user/header.js}"></script>
<script th:src="@{/js/product/productDetail.js}"></script>
<script th:src="@{/js/chat/chat.js}"></script>
<script th:src="@{/js/common/recentViews.js}"></script>
<script th:src="@{/js/common/searchBar.js}"></script>
</body>
</html>